%!TEX root = ../thesis.tex

\chapter[Differential cross section measurement]{Differential cross section measurement}
\label{c:xsection_analysis}
\ifpdf
    \graphicspath{{06_Cross_section_analysis/plots/}}
\else
    \graphicspath{{06_Cross_section_analysis/plots/EPS/}{06_Cross_section_analysis/plots/}}
\fi

% ------------------------------------------------------------------------
Measurement of the differential cross section of the top quark pairs with respect to different variables is an important
precision measurement, but it can also give hints of new physics. For example, measurement of the missing energy in
\ttbar events can represent a search for invisible particles produced in association with top quarks.

The analysis presented in this chapter represents the top quark differential cross section measurement with respect to
event-level (or global) distributions, including the missing transverse momentum (\MET), the scalar sum of jet
transverse momenta (\HT), the scalar sum of the transverse momenta of all objects in the event (\ST), and both the
transverse mass (\MT) and transverse momentum (\WPT) of the leptonically decaying \W boson produced in the top quark
decay \autocite{xsection_PAS_7TeV, xsection_PAS_8TeV}. This measurement is used to validate different Monte Carlo models
and generator tunes. Moreover, it provides a sensitive probe for new physics: for instance, deviations in the tail of
the missing transverse energy distribution could signal new resonances with invisible particles in the final state.

\section{Data and Simulation}
\label{s_xsection:data_and_simulation}

\subsection{Data}
\label{ss_xsection:data}
This analysis uses the full 2012 dataset collected by the CMS detector at a centre of mass energy of \SI{8}{\TeV}, with
a total integrated luminosity of \SI{19.7}{\fbinv}. Only certified events were used in the data, i.e.\ from such
preriods of data-taking when all of the detector subsystems were functioning with no errors. Depending on the channel,
the data were preselected with the single electron or single muon trigger. The preselection procedure as well as full
event selection will be described in Section~\ref{s_xsection:event_selection}.

\subsection{Monte Carlo samples}
\label{ss_xsection:MC_samples}
The Monte Carlo generators used in this work were presented in Section~\ref{sss_top_mass:MC_generators}. The list of
signal and background MC samples is shown in Table~\ref{tab:xsection_mc_samples}, and is largely similar to that from
the top quark mass analysis. In addition, the signal \ttjets sample is also available with \POWHEG and \MCATNLO
generators in order to be able to differentiate between them. Moreover, to extend the statistics of the \W/\ZpJets
samples, they were generated in four exclusive jet multiplicity bins: \W/\Z boson plus one/two/three and at least four
jets.

Table~\ref{tab:xsection_electron_qcd_samples} presents the list of QCD multi-jet background and $\gamma$ + jets samples
used in the estimation of the QCD background in the electron plus jets channel. The analogous set of muon-enriched QCD
samples used in the muon plus jets channel is shown in Table~\ref{tab:xsection_muon_qcd_samples}. Although the QCD
background is estimated using data-driven techniques in both channels (see Section~\ref{s_xsection:data_driven_QCD}),
the MC simulation is still used for normalisation purposes.
% Mention the systematic samples (Table~\ref{tab:xsection_systematic_samples})

\input{06_Cross_section_analysis/tables/xsection_mc_samples}

\subsection{Pile-up reweighting}
\label{sss_xsection:pileup_reweighting}
Since the number of simulated pile-up interactions does not necessarily represent the same distribution in data, a
reweighting procedure for MC events is required. To produce the weights, measured instantaneous luminosity is used to
obtain a distribution of true pile-up vertices in data, i.e.\ before any vertex reconstruction inefficiencies. This
distribution is then divided by the simulated one, and for each number of pile-up interactions, the weight is
calculated. Figure~\ref{fig:pileup_vertices} shows the number of interactions before and after reweighting for both
electron an muon channels. Evidently, the reweighting procedure helps to achieve a good agreement between data and
simulation.

\begin{figure}[!htpb]
\begin{center}
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/EPlusJets_nVertex.pdf}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/EPlusJets_nVertex_reweighted.pdf}} \\
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/MuPlusJets_nVertex.pdf}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/MuPlusJets_nVertex_reweighted.pdf}}
	\caption{\label{fig:pileup_vertices}
    Number of reconstructed vertices per event before (left) and after pile-up reweighting (right) in the electron
    channel (top) and in the muon channel (bottom). Both data and sum of the MC samples are normalised to unit area.}
    %QCD is estimated from MC here. Possible to fix/remove?
\end{center}
\end{figure}

To estimate the number of pile-up vertices in data, the measured instantaneous luminosity in each bunch crossing is
multiplied by an average total inelastic proton-proton cross section. Therefore, two sources of uncertainty arise from
these factors: the luminosity uncertainty, measured to be \SI{4.4}{\pc} by a dedicated study \autocite{CMS_lumi_2012},
and the uncertainty on the total inelastic cross section. To obtain the total cross section value, the CMS measurement
of \SI{68\pm4.5}{\milli\barn} based on \SI{7}{\TeV} data \autocite{CMS_total_inelastic_7TeV} was extrapolated to the
\SI{8}{\TeV} value of \SI{69.3}{\milli\barn}. The recommended uncertainty on this value, set to be \SI{5}{\pc}, covers
the modelling and physics aspects of pile-up simulation that have not been fully studied up to date.

%https://twiki.cern.ch/twiki/bin/viewauth/CMS/PileupSystematicErrors (this has been updated to 69.4mb!)

The effect of the \SI{\pm5}{\pc} variations in total inelastic cross section on the estimate of the true number of
vertices in data is shown in Figure~\ref{fig:pileup_truth}, whereas its effect on the simulated distributions is shown
in Figure~\ref{fig:pileup_vertices_variations} for both electron and muon channels.

 \begin{figure}[hbtp]
   \centering
     \includegraphics[width=\textwidth]{vertices/PileUp_2012_truth_data.pdf}
     \caption{Number of expected vertices per event for central and $\pm \sigma$ variations of the total inelastic cross
     section for the 2012 data.}
     \label{fig:pileup_truth}
 \end{figure}

\begin{figure}[!htpb]
\begin{center}
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/EPlusJets_nVertex_reweighted_PU_down.pdf}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/EPlusJets_nVertex_reweighted_PU_up.pdf}} \\
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/MuPlusJets_nVertex_reweighted_PU_down.pdf}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{vertices/MuPlusJets_nVertex_reweighted_PU_up.pdf}}
	\caption{\label{fig:pileup_vertices_variations}
    Number of reconstructed vertices per event for the $-\sigma$ (left) and the $+\sigma$ variations (right) of
    the pile-up reweighting procedure for the electron channel (top) and the muon channel (bottom).}
\end{center}
\end{figure}


\subsection{b-tagging corrections}
\label{ss_xsection:btagging_corrections}
In order to mitigate the background (QCD in particular), the b-tagging is applied in the event selection of this
analysis. Similarly to the top quark mass analysis, the CSV algorithm with the medium working point providing
\SI{\sim70}{\percent} efficiency and \SI{\sim1}{\percent} mis-tag rate (Section~\ref{sss:b-tagging}) was used. However,
in contrast with the 2011 analysis where the b-tagging corrections were implemented in the construction of the event
likelihood, in this work the scale factors are applied to Monte Carlo events. This is done in order to correct for the
mismatch between the algorithm efficiency seen in data and MC \autocite{btagging_CMS_8TeV_results}. \pt and
$\eta$-dependent scale factors were derived by the CMS b-tag Physics Object Group \autocite{btag_weights_2011} and are
used to reweight the simulated events. The overall jet content of the event is taken into account, such as the number of
jets originating from light and heavy quarks.

\begin{figure}[!htpb]
\begin{center}
	\subfloat[]{\includegraphics[width=0.50\textwidth]{bjets_multiplicity/EPlusJets_N_BJets.pdf}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{bjets_multiplicity/EPlusJets_N_BJets_reweighted.pdf}} \\
	\subfloat[]{\includegraphics[width=0.50\textwidth]{bjets_multiplicity/MuPlusJets_N_BJets.pdf}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{bjets_multiplicity/MuPlusJets_N_BJets_reweighted.pdf}}
	\caption{\label{fig:bjet_weights}
    b-tag multiplicity before (left) and after applying b-tag scale factors (right) in the electron channel (top) and
    the muon channel (bottom).}
\end{center}
\end{figure}

Figure \ref{fig:bjet_weights} shows the results of the reweighting procedure for electron and muon channels. It can be
seen that the numbers of simulated events in b-tag multiplicity bins of \num{0} and \num{1} are scaled up, whereas for
other bins the number of MC events is scaled down. The systematic uncertainty due to b-tagging corrections is calculated
by applying $\pm 1 \sigma$ variations of the scale factors in the reweighting procedure.

\section{Event Selection}
\label{s_xsection:event_selection}
As in the top quark mass analysis, the event selection in this work is based on the standard CMS selection optimised for
the Standard Model \ttbar production. It also exploits the semi-leptonic signature of a \ttbar decay with exactly one
isolated lepton and at least four jets, two of which are b-tagged. One of the main goals of the analysis is the
measurement of the missing transverse energy distribution represented by a neutrino from the leptonic decay of the \W
boson, however, there is no specific requirement on the \MET in the selection.

Comparing to the 2011 event selection described in Section~\ref{s_top_mass:event_selection}, enhanced pile-up
subtraction and lepton identification techniques are used. Improved understanding of the detector in form of updated
alignment and calibration constants resulted in better resolution of jets and \MET. The preselection (or skimming) step
used in order to reduce the number of events for local analysis processing is identical to that of 2011 analysis.
However, additional filters are used to reject the events with artificial \MET caused by noise or known problems with
one of the detector subsystems. These filters are discussed in Section~\ref{ss_xsection:met_filters}.

Two semi-leptonic \ttbar decay modes are explored in this analysis: the electron plus jets and the muon plus jets
channels. The event selection for each of these decay modes is described below.

\subsection{Electron plus jets channel}
\label{ss_xsection:ejets}

Similarly to the electron plus jets channel in the top quark mass analysis, the selection consists of the following
steps:

\begin{enumerate}[topsep=\parskip, parsep=\parskip, itemsep=\parskip, leftmargin=\leftmargin]
	\item preselection;
	\item trigger;
	\item electron candidate selection;
	\item muon veto;
	\item dilepton veto;
	\item conversion veto;
	\item jet selection;
	\item b-tagging.
\end{enumerate}

%https://twiki.cern.ch/twiki/bin/view/CMS/TWikiTop2011DataMCTrig

\subsubsection*{Trigger}
As opposed to 2011 analysis using cross triggers, a single electron trigger is used in this analysis. Referred to as
HLT\_Ele27\_WP80, this trigger has a lepton \pt threshold of \SI{27}{\GeV} and ``WP80'' lepton isolation requirement
(see Table~\ref{tab:trigger_naming}), but no specific jet requirements. In contrast to 2011 data-taking, the single
electron trigger was unprescaled for the whole period of 2012 running, despite a comparatively large rate. This decision
was made due to simplicity of the trigger selection, requiring flat efficiency corrections.

\subsubsection*{Electron candidate selection}
Similarly to 2011 selection, exactly one electron candidate passing is required in the event, passing the following
criteria:

\begin{itemize}
	\item $\ET > \SI{30}{\GeV}$;
	\item $|\eta| < 2.5$, excluding the ECAL barrel-endcap transition regions of $1.4442 < |\eta| < 1.566$;
	\item MVA electron ID (Section~\ref{ss:electron_reconstruction}) with a discriminator cut of $>0.5$;
	\item transverse impact parameter with respect to the primary vertex $d_{xy} < \SI{0.02}{\cm}$;
	\item PF-based relative isolation (Section~\ref{sss:electron_isolation}) \reliso $< 0.1$ with a $\Delta
R$ cone of \num{0.3}.
\end{itemize}

\subsubsection*{Muon veto}
To reduce contamination from other \ttbar decay modes (i.e.\ muon and dilepton channels), events containing a global or
a tracker muon (see Section \ref{ss:muon_reconstruction}) are rejected. The requirements on the muon are identical to
those of 2011 selection: $\pt > \SI{10}{\GeV}$, $|\eta| < 2.5$ and $\reliso < 0.2$ with a $\Delta R$ cone of \num{0.4}.

\subsubsection*{Dilepton veto}
To reject events with additional electrons, dilepton veto is applied. Events are rejected if they contain a second
electron candidate with the same ID and $\eta$ requirements, but looser \ET and \reliso criteria ($>\SI{20}{\GeV}$ and
$<0.15$, respectively).

\subsubsection*{Conversion veto}
As described in Section~\ref{sss:photon_conversions}, a vertex fit technique combined with the number of missing hits
in the tracker is used for photon conversion rejection.

\subsubsection*{Jet selection and b-tagging}
To help further reduce the background, at least four jets with $\pt > \SI{30}{\GeV}$ and $|\eta| < 2.5$ are required in
the event. These jets are required to pass the loose PF jet ID (see Section \ref{ss:jet_reconstruction}). Before the
multiplicity and identification requirements, the collection of jets is cleaned against the signal electron, i.e.\ any
jet within a $\Delta R$ cone of \num{0.3} around the signal lepton is excluded from the analysis. This is done due to
the fact that an electron may be reconstructed as a jet by leaving a characteristic signature in calorimeters. Any
additional jets with $\pt > \SI{20}{\GeV}$ and the same cleaning and ID requirements are also used for calculation of
\HT and \ST variables (Section~\ref{ss_xsection:variables}). Finally, the combined secondary vertex (CSV) b-tagging
algorithm with the medium working point (Section \ref{sss:b-tagging}) is used to identify the jets originating from
\cPqb-quarks in the \ttbar decay. At least two b-tagged jets are required in this analysis.

\subsection{Muon plus jets channel}
\label{ss_xsection:mujets}
The muon channel event selection follows similar strategy as that of the electron channel:

\begin{enumerate}[topsep=\parskip, parsep=\parskip, itemsep=\parskip, leftmargin=\leftmargin]
	\item preselection;
	\item trigger;
	\item muon candidate selection;
	\item second muon veto;
	\item electron veto;
	\item jet selection;
	\item b-tagging.
\end{enumerate}

\subsubsection*{Trigger}
An isolated single muon trigger, referred to as HLT\_IsoMu24\_eta2p1, is used in this channel. Partially suggested by
the name of the trigger path, the following criteria on the muon are imposed at the HLT level:

\begin{itemize}
	\item $\pt > \SI{24}{\GeV}$;
	\item $\abs \eta < 2.1$;
	\item Combined tracker and calorimeter-based relative isolation (Section~\ref{sss:electron_isolation}) \reliso $<
0.15$ with a $\Delta R$ cone of 0.3.

% according to https://twiki.cern.ch/twiki/bin/viewauth/CMS/MuonHLT isolation used to be 0.1, dR=0.24 in RunA
\end{itemize}

\subsubsection*{Muon candidate selection}
For selection of a muon candidate, exactly one muon satisfying the following requirements is required:

\begin{itemize}
	\item $\pt > \SI{26}{\GeV}$;
	\item $|\eta| < 2.1$;
	\item PF-based relative isolation (Section~\ref{sss:electron_isolation}) \reliso $< 0.12$ with a $\Delta
R$ cone of \num{0.4};
	\item PF-muon ID criteria (Section \ref{ss:muon_reconstruction}):
	\begin{itemize}
		\item identified as a particle flow muon and as a global muon;
		\item a normalised of the global muon fit $\chi^2<10$;
		\item number of muon chamber hits $>0$;
		\item number of muon stations with muon segments $>1$;
		\item transverse impact parameter w.r.t. the primary vertex $d_{xy} < \SI{0.02}{\cm}$;
		\item longitudinal distance of the tracker track w.r.t. the primary vertex $d_z < \SI{0.5}{\cm}$;
		\item number of hits in the pixel detector $>0$;
		\item number of hits in the tracker layers $>5$.
	\end{itemize}
\end{itemize}

\subsubsection*{Second muon veto}
Events containing an additional loose muon are rejected, with loose ID requirements as follows:

\begin{itemize}
	\item $\pt > \SI{10}{\GeV}$;
	\item $|\eta| < 2.5$;
	\item PF-based relative isolation (Section~\ref{sss:electron_isolation}) \reliso $< 0.2$ with a $\Delta R$ cone of
	\num{0.4}; %PU corrections!
	\item identified as a particle flow muon, and either global or tracker muon.
\end{itemize}

These criteria are identical to the muon veto requirements in the electron channel.

\subsubsection*{Electron veto}
To further reduce background contamination, events with electrons are rejected. The requirements on additional loose
electron are the same to the dilepton veto in the electron channel.

\subsubsection*{Jet selection and b-tagging}
Finally, the jet requirements are applied. These are also identical to those of the electron channel, mentioned above.


% \begin{figure}[!htp]
%    \centering
%    \subfloat[]{\includegraphics[width=0.5\textwidth]{placeholder}}
%    \subfloat[]{\includegraphics[width=0.5\textwidth]{placeholder}}
%    \hfill
%    \subfloat[]{\includegraphics[width=0.5\textwidth]{placeholder}}
%    \subfloat[]{\includegraphics[width=0.5\textwidth]{placeholder}}
%    \caption{\label{fig:controlplots}Kinematic variable distributions after all selection cuts. (a) electron \pt, (b)
%    electron $\eta$, (c) jet \pt for all jets passing the selection, (d) \MET.}
% \end{figure}

\subsection{Additional filters for missing transverse energy}
\label{ss_xsection:met_filters}
%https://twiki.cern.ch/twiki/bin/viewauth/CMS/MissingETOptionalFilters

There is no specific requirement on missing transverse energy in the selection, however, a set of corrections is applied
to \MET. As described in Section~\ref{ss:MET_reconstruction}, jet energy corrections are propagated to \MET, and it is
also corrected for pile-up and various detector effects causing $\phi$ modulation.

Additionally, a set of optional filters, prescribed for analyses with high sensitivity to \MET, was applied in the
selection for both electron and muon channels. Most of these filters were put in place after discovering events with
anomalously high missing transverse energy. A short description of each filter is given below.

\begin{description}[wide=\parindent]
	\item[CSC beam halo filter.]
	Protons in the LHC beams can interact with residual particles of beam collimators, which produces secondary particle
	showers refered to as beam halo \autocite{beam_halo_CMS}. This machine-induced background can significantly
	contaminate collision events, particularly affecting the \MET observable due to specific trajectories of halo muons.
	A dedicated algorithm based on exploiting the halo signatures in the Cathode Strip Chambers (CSCs) helps to mitigate
	this background.

	\item[HCAL laser filter.] The HCAL laser system is used for calibration and monitoring the detector response
	\autocite{CMS_TDR1}. During the 2012 data-taking, laser pulses were accidentally fired and consequently polluted a
	small fraction of the recorded physics dataset. Using the fact that unlike physics events, laser pulses produce hits
	in calibration channels of the HCAL, the dataset is filtered from this contamination.
	%https://indico.cern.ch/event/169318/contribution/1/material/slides/0.pdf

	\item[ECAL dead cell filter.] Both ECAL endcap and barrel regions are known to have faulty crystals producing too
	much noise in detector readouts. There are also crystals corresponding to front-end cards with defective data link.
	All these channels are masked in reconstruction and constitute to about \SI{1}{\pc} of the total amount. However,
	they can still cause a significant amount of energy deposits to be lost, therefore contributing to fake \MET. One of
	the approaches to tackle this issue uses the so-called trigger primitive information, i.e.\ digital quantities
	produced by the Level 1 trigger electronics \autocite{CMS_L1_Trigger_TDR}. Another approach uses the energy deposits
	surrounding the masked channels (boundary energy). These methods allow to filter events with the estimated energy
	leakage above certain threshold (\SI{\sim10}{\GeV}).
	%https://twiki.cern.ch/twiki/bin/viewauth/CMS/SusyEcalMaskedCellSummary

	\item[Tracking failure filter.] Some events have been observed to have a lack of tracks corresponding to standard or
	large calorimeter deposits. There are two understood sources of this misreconstruction: in a first type of such
	events, the tracking algorithm (explained in Section~\ref{ss:electron_reconstruction}) halts for some of its
	iterations due to an exceeding number of calorimeter clusters. In a second type the hard collision happens at a
	distance of approximately \SI{75}{\cm} from the nominal interaction point. A cut on the summed \pt of the tracks
	originating from the primary vertices passing the preselection criteria, divided by the summed \pt of all jets in
	the event, was found to clearly distinguish between pathological and unaffected events. A cut value of \SI{10}{\pc}
	is imposed.
	%https://twiki.cern.ch/twiki/bin/viewauth/CMS/SusyRA2NJetsInData2010#Tracking_failure

	\item[Bad ECAL endcap super-cluster filter.] In 2012, two $5\times5$ super-clusters in the ECAL endcap regions were
	observed to occasionally produce anomalous pulses, leading to artificially high \MET. The source of this issue can
	be related to the High-Voltage system, but is subject to further investigation. A filter removing the problematic
	events is used, configured to cut on the total energy of reconstructed hits not passing the nominal quality criteria
	in the two super-clusters, with the cut value of \SI{1}{\TeV}.
	%https://twiki.cern.ch/twiki/bin/viewauth/CMS/MissingETOptionalFilters#Bad_EE_Supercrystal_filter_added

	\item[ECAL laser correction filter.] Lead tungstate crystals of the ECAL naturally lose their transparency with
	radiation exposure. To maintain high precision, this effect is corrected for by frequently injecting laser pulses
	and reading out the response in order to calibrate each crystal \autocite{CMS_TDR1}. During 2012 data-taking, a
	handful of crystals unphysically large values of laser corrections, resulting in anomalously high \MET in recorded
	events. The filter removes such events from the dataset.
	%https://twiki.cern.ch/twiki/bin/viewauth/CMS/PdmVKnowFeatures#Filter_to_reject_events_with_ano

	\item[Strip tracker noise filter.] A few events were affected by a large coherent noise in the silicon strip
	tracker, which resulted in a much larger number of the strip clusters compared to according pixel cluster
	multiplicity in the tracking algorithm. A dedicated filter rejects events with this anomaly.
	%https://twiki.cern.ch/twiki/bin/viewauth/CMS/TrackingPOGFilters#Filters

\end{description}

\section{Data-driven QCD estimation}
\label{s_xsection:data_driven_QCD}
The QCD multi-jet events constitute an important background to semi-leptonic \ttbar decays, and one of the most
difficult to model (Section~\ref{ss:backgrounds}). The two b-tagged jets requirement in the event selection is mainly
motivated by the necessity to mitigate the effect of this particular background. In this analysis, the final QCD yield
is obtained from the fitting process as explained in Section~\ref{s_xsection:measurement}. However, the initial estimate
is performed using the data-driven techniques. Only the shape of the distribution is of importance here as the
normalisation is determined in the fitting process. The QCD estimation methods for both electron and muon channel are
described in detail hereafter.

\subsection{QCD multi-jet events with electrons}
Two control regions have been investigated in the electron channel:

\begin{itemize}
\item conversion control region: conversion veto is inverted in the full event selection;
\item non-isolated electron control region: the electron isolation requirement is changed from $\reliso < 0.1$ to
$\reliso > 0.2$.
\end{itemize}

Additionally, only events with no b-tagged jets are taken into account to increase the statistics and QCD purity in both
control regions. Both control regions are presented on Figure~\ref{fig:qcd_control_regions_eta}, and the QCD shapes are
compared for the electron absolute pseudorapidity distribution as this observable is used in the fitting procedure. It
can be seen that the distributions are not well described by the Monte Carlo, e.g.\ occasional high peaks in the QCD MC
represent the lack of statistics in simulation. Moreover, the two control regions have considerably different shapes in
the electron $\abs \eta$ distributions. For the conversion control region, the shape is mostly flat in the barrel region
($\abs \eta < 1.5$) and peaks in the endcap region ($\abs \eta > 1.5$), which is expected as the conversions are more
likely to happen in the region with higher material budget. In contrast, the non-isolated control region peaks in the
pseudorapidity region of $1.0 < \abs \eta < 1.5$. Such behaviour is correlated with the jet $\abs \eta$ distribution,
since this control region favours non-isolated electrons coming from heavy quark decays.

\begin{figure}[hbtp]
  \begin{center}
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{QCD/QCD_conversion_control_region_electron_AbsEta_0btag}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{QCD/QCD_non_iso_control_region_electron_AbsEta_0btag}} \\
	\subfloat[]{\includegraphics[width=0.50\textwidth]{QCD/QCD_control_region_comparison_electron_AbsEta_0btag}}
    \caption{Distribution of the electron $\abs \eta$ for conversion selection (a), non-isolated electron selection
    (b) and the shape comparison of both QCD control region in data (c) in electron plus jets events with at least
    four jets and 0 b-tagged jets.}
    \label{fig:qcd_control_regions_eta}
  \end{center}
\end{figure}

Due to the fact that the non-isolated control region has a significant contamination from signal and \W/\ZpJets events,
the conversion region was chosen to produce the QCD template for the electron channel. However, since the relative
contributions of the QCD events from both control regions in the final selected sample are not known, the real QCD shape
can differ considerably from the prediction. Therefore, the non-isolated region is used to estimate the systematic
uncertainty due to the QCD shape choice.

\subsection{QCD multijet events with muons}
For the QCD shape extraction in the muon plus jets channel, the inverted isolation cut is applied in the event
selection: at least one muon with $\reliso>0.3$ is required, and events with isolated muons with $\reliso<0.3$ are
vetoed. Similarly to the electron channel, only events with no b-tagged jets are taken into account. Additionally, to
increase the available statistics, events with only three jets are also considered ($\geq 3$ jet bin).

The relative isolation distribution with the cut value and the muon $\abs \eta$ for the non-isolated region are shown on
Figure~\ref{fig:qcd_muon_plots}. Clearly, the control region is dominated by QCD events and generally there is a
reasonable agreement between data and simulation. The contamination from other processes is subtracted using Monte
Carlo.

\begin{figure}[hbtp]
  \begin{center}
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{QCD/QCD_muon_pfIsolation_0btag}}\hfill
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{QCD/QCD_non_iso_control_region_muon_AbsEta_0btag}}
    \caption{Muon relative isolation with no isolation cut (a) and muon $\abs \eta$ (b) for non-isolated ($\reliso >
    0.3$) selection in muon plus jets events with at least three jets and 0 b-tagged jets. The vertical red line on plot
    (a) shows the \reliso cut value of \num{0.3}.}
    \label{fig:qcd_muon_plots}
  \end{center}
\end{figure}

\section{Data/MC comparison}
\label{s_xsection:data_mc_comparison}
%explain the MC error on the plots. explain the yields.

In this section, the agreement between simulation and data for various kinematic distributions is reviewed after the
final event selection. The event yields for all selection steps described in Section~\ref{s_xsection:event_selection}
are shown in Tables~\ref{tab:event_yields_ejets} and \ref{tab:event_yields_mujets} for the electron and muon channels,
respectively. All background events are normalised to the number of expected events for the total integrated luminosity
of \SI{19.7}{\fbinv}.

The QCD multi-jet background events shown in plots are derived using the data-driven methods explained previously.
Figure~\ref{fig:contol_plots_leptons} shows the lepton \pt and $\abs \eta$ distributions for both electrons and muons.
In Figure~\ref{fig:contol_plots_METs}, missing transverse energy distributions are shown, also including the
logarithmic scale for higher values of \MET. Figure~\ref{fig:contol_plots_phiMET_NJets} shows the azimuthal angle of
\MET ($\phi(\MET)$) and jet multiplicity distributions for both channels. The \ttbar uncertainty shown in the plots
refers to the theoretical uncertainty on the NNLO calculation of the total \ttbar cross section at \SI{8}{\TeV}
\autocite{NNLO_ttbar} used in this analysis.

Overall, good agreement is found between data and Monte Carlo simulation in all kinematic distributions. One should note
that the comparison shown is made before the fitting process, which is described in
Section~\ref{s_xsection:measurement}.

\input{06_Cross_section_analysis/tables/xsection_event_yields}

\begin{figure}[hbtp]
  \begin{center}
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/electron_pT_2orMoreBtags_with_ratio}}\hfill
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/muon_pT_2orMoreBtags_with_ratio}} \\
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/electron_AbsEta_2orMoreBtags_with_ratio}}\hfill
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/muon_AbsEta_2orMoreBtags_with_ratio}}
    \caption{Data/MC comparison plots after the final event selection: electron \pt (a), muon \pt (b), electron $\abs
    \eta$ (c) and muon $\abs \eta$ (d). Left plots: electron+jets selection, right plots: muon+jets selection.}
    \label{fig:contol_plots_leptons}
  \end{center}
\end{figure}

\begin{figure}[hbtp]
  \begin{center}
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/EPlusJets_patType1CorrectedPFMet_2orMoreBtags_with_ratio}}\hfill
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/MuPlusJets_patType1CorrectedPFMet_2orMoreBtags_with_ratio}} \\
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/EPlusJets_patType1CorrectedPFMet_log_2orMoreBtags_with_ratio}}\hfill
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/MuPlusJets_patType1CorrectedPFMet_log_2orMoreBtags_with_ratio}} \\
    \caption{Data/MC comparison plots of \MET (a, b) and logarithmic view of \MET (c, d) after the final event
    selection. Left plots: electron+jets selection, right plots: muon+jets selection.}
    \label{fig:contol_plots_METs}
  \end{center}
\end{figure}

\begin{figure}[hbtp]
  \begin{center}
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/EPlusJets_patType1CorrectedPFMet_phi_2orMoreBtags_with_ratio}}\hfill
	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/MuPlusJets_patType1CorrectedPFMet_phi_2orMoreBtags_with_ratio}} \\
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/EPlusJets_N_Jets_2orMoreBtags_with_ratio}}\hfill
  	\subfloat[]{\includegraphics[width=0.50\textwidth]{control_plots/MuPlusJets_N_Jets_2orMoreBtags_with_ratio}} \\
    \caption{Data/MC comparison plots of $\phi(\MET)$ (a, b) and jet multiplicity (c, d) after the final event
    selection. Left plots: electron+jets selection, right plots: muon+jets selection.}
    \label{fig:contol_plots_phiMET_NJets}
  \end{center}
\end{figure}

\newpage

\section{Differential cross section measurement}
\label{s_xsection:measurement}

\subsection{Primary variables}
\label{ss_xsection:variables}

In this analysis, the normalised differential cross section of \ttbar production is studied with respect to five primary
variables:

\begin{itemize}
	\item \MET, or missing transverse momentum;
	\item \HT, or scalar sum of jet transverse momenta;
	\item \ST, or scalar sum of the transverse momenta of all objects in the event;
	\item \MT, or transverse mass of the leptonically decaying \W boson;
	\item \WPT, or transverse momentum of the leptonically decaying \W boson.
\end{itemize}

These observables are often called event-level (or global) variables due to the fact that no high-level kinematic
reconstruction (e.g.\ that of a \ttbar pair) is required to calculate them. A lower level of complexity makes these
variables less prone to inefficiencies, systematic errors or biases arising from various kinematic reconstruction
techniques. Hence, global variables can provide better sensitivity in comparison of different theoretical models or
generator tunes.

\MET is commonly referred to as the missing transverse energy, which is equivalent to missing transverse momentum under
assumption that the missing particles contributing to \MET are massless. It is defined as the negative of the vector sum
of the transverse momenta of all reconstructed particles in an event. Therefore, its direction is opposite to the
observed sum of transverse momentum, with the magnitude of
\[ \MET = - \left[ \left(\sum_i{p_{x}^i}\right)^2 + \left(\sum_i{p_{y}^i}\right)^2 \right]^{\frac{1}{2}}\]
where the sums are calculated over all measured particles in the event.

\HT is defined as the scalar sum of the transverse momenta of all reconstructed jets in the event:
\[\HT = \sum_{\mathrm{all~jets}}\pt^{\mathrm{jet}}\]
Here all jets are required to have a \pt $>$ \SI{20}{\GeV} as described in Section~\ref{s_xsection:event_selection}.

\ST represents the sum of \HT, \MET and the \pt of the single isolated lepton: 
\[\ST = \HT + \MET + p_\mathrm{T}^\mathrm{lepton}\]

\WPT refers to the transverse momentum of the leptonically decaying \W boson, which is calculated from the single
isolated lepton and \MET assumed to originate from the \ttbar decay:
\[\WPT = \sqrt{(p_x^{\mathrm{lepton}} + p_x^{\mathrm{miss}})^2 + (p_y^{\mathrm{lepton}} + p_y^{\mathrm{miss}})^2}\]

Finally, \MT is defined as the transverse mass of the leptonically decaying \W boson, also using the single isolated
lepton and \MET:
\[\MT = \sqrt{(\ET {}^{\mathrm{lepton}} +\met)^2 - \wpt {}^2}\]
where $\ET {}^{\mathrm{lepton}}$ denotes the transverse energy of the lepton.

\subsection{Fitting procedure}
\label{ss_xsection:fitting}

\subsection{Choice of binning}
\label{ss_xsection:binning}

% In order to improve the differential cross section measurement, the binning of the variables must be chosen carefully so
% as to minimise migration between neighbouring bins. The event statistics within a bin must also be substantial such that
% the likelihood fit can be performed. In order to quantify the effect of bin migration, two parameters, bin purity, $p^k$
% and stability, $s^k$, are defined:

% \begin{eqnarray}
% p^k = \frac{N_{\rec\&\gen}^k}{N_{\rec}^k} \\
% s^k = \frac{N_{\rec\&\gen}^k}{N_{\gen}^k}
% \end{eqnarray}

% where $N_{\rec\&\gen}^k$ is the number of events both generated and reconstructed in the same bin and
% $N_{\rec}^k$/$N_{\gen}^k$ is the number of events reconstructed/generated within a bin. The purity parameter is
% sensitive to migration into a bin while the stability parameter is sensitive to migration out of a bin. Binning is
% chosen such that the $p^k$ and $s^k$ values do not fall far below 0.5. We can see that the values for all the variables
% are consistent between the electron and muon channels in tables...


\begin{figure}[hbtp]
	\centering
	%MET
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/EPlusJets_MET}}\hfill
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/MuPlusJets_MET}}\\
	%HT
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/EPlusJets_HT}}\hfill
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/MuPlusJets_HT}}\\ 
	%ST
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/EPlusJets_ST}}\hfill
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/MuPlusJets_ST}}\\ 

	\caption{Reconstructed versus generated \MET (a, b), \HT (c, d) and \ST (e, f) for electron plus jets (left) and
	muon plus jets events (right).}
	\label{fig:choice_of_metbins_1}
 \end{figure}

\begin{figure}[hbtp]
	\centering
	%WPT
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/EPlusJets_WPT}}\hfill
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/MuPlusJets_WPT}}\\
	%MT
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/EPlusJets_MT}}\hfill
	\subfloat[]{\includegraphics[width=0.5\textwidth]{binning/MuPlusJets_MT}}\\

	\caption{Reconstructed versus generated \WPT (a, b), \MT (c, d) for electron plus jets (left) and muon plus jets
	events (right).}
	\label{fig:choice_of_metbins_2}
 \end{figure}

\subsection{Unfolding}
\label{ss_xsection:unfolding}

\section{Systematic Uncertainties}
\label{s_xsection:systematics}

\section{Results}
\label{s_xsection:results}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../thesis"
%%% End: 
